var GlobalActionMenu;(function(n){function ft(n){var i=n.querySelector(".actionmenuexp"),r=n.querySelector("."+o),t=n.querySelector(".actionmenucontent"),u=n.querySelector("."+y);t&&(st(u,i,r,t,n),ot(u,i,r,t,n))}function t(n,t,i,e,o,s){var g,y,p,c,w,h;if(!Lib.CssClass.contains(e,f)){ht(n,t,i);var b=Lib.CssClass.contains(e,u),k=Lib.CssClass.contains(e,r),nt=!b&&!k;for(Lib.CssClass.add(e,f),Lib.CssClass.add(e,v),Lib.CssClass.remove(e,r),Lib.CssClass.remove(o,a),Lib.CssClass.remove(e,u),g=o.firstElementChild,y=g.getElementsByTagName("a"),h=0;h<y.length;h++)y[h].setAttribute("aria-expanded","false");if(sb_st(function(){return sj_evt.fire("GlobalActionMenu:Closed")},1e3),p=function(n){s?s.focus():n&&n.focus()},b||d(!1,e),k){if(c=l(),w=!1,c)for(h=0;h<c.length;h++)c[h].parentElement==i.parentElement&&(c[h].focus(),w=!0);w||p(i)}nt&&p(t)}}function et(n,t){var e=Lib.CssClass.contains(n,u),r,i;for(Lib.CssClass.add(t,a),Lib.CssClass.remove(n,v),Lib.CssClass.remove(n,f),r=n.getElementsByClassName(w),i=0;i<r.length;i++)Lib.CssClass.remove(r[i],w);sb_st(function(){return sj_evt.fire("GlobalActionMenu:Opened")},1e3);e||d(!0,n)}function ot(n,i,r,f,e){var c,l,o,h;if(sj_evt.bind(s,function(){return t(n,i,r,f,e)}),c=function(n){for(var t=n&&n.target;t;t=t.parentElement)if(t==f||t==i)return;sj_evt.fire(s)},sj_be(_d,"touchstart",c),sj_be(_d,"mousedown",c),sj_be(f,"touchstart",function(n){return n.stopPropagation()}),Lib.CssClass.contains(f,u)||sj_be(f,"click",function(){return t(n,i,r,f,e)}),sj_be(f,"touchmove",function(){return t(n,i,r,f,e)}),l=function(){var u=document.activeElement,o;i&&i.contains(u)&&(o=i);r&&r.contains(u)&&(o=r);f.contains(u)||t(n,i,r,f,e,o)},AccessibilityHelpers.activateButtonByKey(f,[9],l),AccessibilityHelpers.activateButtonByKey(f,[13,32],function(){return t(n,i,r,f,e)}),e&&(o=e.querySelectorAll("a"),o))for(h=0;h<o.length;h++)sj_be(o[h],"keydown",function(u){u.keyCode==27&&t(n,i,r,f,e)});i&&(sj_be(i,"touchstart",function(n){return n.stopPropagation()}),sj_be(i,"touchmove",function(){return t(n,i,r,f,e)}),sj_be(i,"keydown",function(u){u.keyCode==27&&t(n,i,r,f,e)}));r&&(sj_be(r,"touchstart",function(n){return n.stopPropagation()}),sj_be(r,"mousedown",function(n){return n.stopPropagation()}),sj_be(r,"touchmove",function(){return t(n,i,r,f,e)}),sj_be(r,"keydown",function(u){u.keyCode==27&&t(n,i,r,f,e)}));n&&(sj_be(n,"touchstart",function(n){return n.stopPropagation()}),sj_be(n,"mousedown",function(n){return n.stopPropagation()}),sj_be(n,"touchmove",function(){return t(n,i,r,f,e)}),sj_be(n,"keydown",function(u){u.keyCode==27&&t(n,i,r,f,e)}))}function st(n,t,c,a,v){var nt=a.offsetWidth,g,w;Lib.CssClass.add(a,r);g=a.offsetWidth;Lib.CssClass.remove(a,r);Lib.CssClass.contains(v,ut)&&(nt=p,g=p);w=function(c){c.setAttribute("aria-expanded","true");var ut=function(n,t){et(a,v);n?(Lib.CssClass.add(a,r),b(v,c,a,g)):t?Lib.CssClass.add(a,u):b(v,c,a,nt)},p=Lib.CssClass.contains(c,o),d=Lib.CssClass.contains(c,y),w=Lib.CssClass.contains(a,f),ft=!w&&Lib.CssClass.contains(a,r),ot=!w&&Lib.CssClass.contains(a,u),tt=v.getAttribute(h)&&v.getAttribute(h)===c.getAttribute("id"),rt=w||ft!=p||ot!=d,k=l();(!tt||rt)&&sj_evt.fire(s);rt?(p?(i(n,-1),i(t,-1),e(k,-1)):(i(n,0),i(t,0),e(k,0)),sb_st(function(){return ut(p,d)},tt?0:it)):(i(n,0),i(t,0),e(k,0))};t&&(sj_be(t,"click",function(){return w(t)}),AccessibilityHelpers.activateButtonByKey(t,[13,32],function(){return w(t)}));c&&(sj_be(c,"click",function(){return w(c)}),AccessibilityHelpers.activateButtonByKey(c,[13,32],function(){return w(c)}));n&&(sj_be(n,"click",function(){return w(n)}),AccessibilityHelpers.activateButtonByKey(n,[13,32],function(){return w(n)}));var d=_d.getElementById(v.getAttribute(h)),k,tt=function(){k&&sb_ct(k);k=sb_st(function(){return w(d)},500)},rt=function(){k&&(sb_ct(k),k=null)};d&&(sj_be(d,"mouseenter",tt),sj_be(d,"mouseleave",rt))}function ht(n,t,r){e(l(),0);i(n,0);i(t,0);i(r,0)}function i(n,t){n&&(n.tabIndex=t)}function e(n,t){if(n)for(var r=0;r<n.length;r++)i(n[r],t)}function b(n,t,i,r){if(t&&i){var a=t.getBoundingClientRect(),e=t.offsetWidth?t.offsetWidth:0,o=t.offsetHeight?t.offsetHeight:0,f=a.left,s=_w.innerWidth-f-e,h=a.top,v=_w.innerHeight-h-o;i.style.position="fixed";f>s?f+e<r?(i.style.left="0",i.style.right=""):(i.style.left="",i.style.right=s+"px"):s+e<r?(i.style.left="",i.style.right="0"):(i.style.left=f+"px",i.style.right="");h>v?(i.style.top="",i.style.bottom=v+o+"px"):(i.style.bottom="",i.style.top=h+o+"px");var y=n.getBoundingClientRect(),u=i.getBoundingClientRect(),c=u.left-y.left,l=u.top-y.top,p=u.top,w=u.left;i.style.right="";i.style.bottom="";i.style.left=c+"px";i.style.top=l+"px";i.style.position="absolute";u=i.getBoundingClientRect();c+=w-u.left;l+=p-u.top;i.style.top=l+"px";i.style.left=c+"px"}}function k(n,t){var r=n.querySelectorAll(t),i,u,f;if(r)for(i=0;i<r.length;i++)u=r[i],f=u.getAttribute("data-medium"),Sharing.logEvent(f,Sharing.ShareStage.Visible,"GlobalAction sharing",n)}function d(n,t){_w.Log2?Log2.LogEvent("ClientInst",{FID:"GlobalAction.Expansion",AppNS:g(t),K:nt(t),Category:"CommonControls"},n?"Open":"Close",null,null,null,null,null):Log.Log(n?"Open":"Close","GlobalAction.Expansion","ClientInst",!1,"AppNS",g(t),"K",nt(t),"Category","CommonControls");n&&k(t,"[data-type='shareMedium']")}function c(){var r=_d.querySelectorAll(n.globalActionMenuSelector),u,i,t;if(r)for(u="data-initialized",i=0;i<r.length;i++)(t=r[i],t.getAttribute(u)!=="1")&&(ft(t),k(t,".topactions [data-type='shareMedium']"),t.setAttribute(u,"1"))}function l(){return typeof PrintAction!="undefined"?PrintAction.getPrintActions():null}function ct(){c();typeof ShareAction!="undefined"&&ShareAction.initShareActions();typeof PrintAction!="undefined"&&PrintAction.initPrintActions();typeof FeedbackAction!="undefined"&&FeedbackAction.initFeedbackActions();typeof CustomAction!="undefined"&&CustomAction.initCustomActions()}function lt(n,t){var i=n&&_qs(".".concat(o),n);at(i,t)}function at(t,i){t&&(n.promoteActionImpl?n.promoteActionImpl(t,i):vt(function(){n.promoteActionImpl&&n.promoteActionImpl(t,i)}))}function vt(n){var t="".concat(rt,"?IG=").concat(_G.IG),i={callback:function(t,i){t&&(i.appendTo(sj_b),n())}};sj_ajax(t,i)}function g(n){return tt(n,"appns")}function nt(n){return tt(n,"k")}function tt(n,t,i){if(i===void 0&&(i=null),!n)return null;var r="data-"+t;return i===null?n.getAttribute(r):(n.setAttribute(r,i),i)}var a="openmenu",f="hiddenmenu",v="nonemenu",r="sharemenu",o="shareactionexp",s="menuDismiss",y="cortanaactionexp",u="cortanamenu",it=200,rt="/shared/gamp/",h="data-hoverid",ut="actionmenularge",p=430,w="ga_cpy_label_copied";n.globalActionMenuSelector=".actionmenu";n.bindGlobalActionMenuEvents=ct;n.promoteShareAction=lt;sj_be(_w,"load",function(){return c()});sj_evt.bind("ajax.load",function(){return c()})})(GlobalActionMenu||(GlobalActionMenu={}))